<html>
	<head>
		<script src="./lib/jquery-1.10.2.js"></script>
		<script src="./lib/jquery.event.drag-2.2.js"></script>
		<script src="./lib/slick.core.js"></script>
		<script src="./lib/slick.grid.js"></script>

		<script src="./app/testdata.js"></script>
		<!--script src="./lib/slick-poc.js"></script-->
	
	    <link rel="stylesheet" href="./css/slick.grid.css" type="text/css"/>
		<link rel="stylesheet" href="./css/datagrid.css" type="text/css"/>
		<link rel="stylesheet" href="./css/jquery-ui-1.8.16.custom.css" type="text/css"/>

	</head>
	
	<body>

		<div>
			<input id="add" type="button" value="Add" />
			<input id="nrow" placeholder=" n rows"/><br/>
		</div>

		<div id="dataGrid" style="width:800px;height:500px; border: 1px solid;"></div>

		<!--script>
			var spc = new SlickPocGrid("#dataGrid");

			testdata.onReady(spc.loadInititalData);
		</script-->

		<script>

		$("#add").click(function(event){
			
			var n = $("#nrow").val();

			if( n ) {
				console.log('add ' + n + ' row(s)');

				$.merge(data,testdata.getRandomRows(n));

				grid.updateRowCount();
				grid.render();

				console.log('row count: ' + data.length);

			}
		
		});

		function deleteRowLink( row, cell, value, columnDef, dataContext ) {
        	return '<a onclick="deleteRow(' + row + ')" href="javascript:void(0);">delete</a>'
    	};

    	function deleteRow(index) {
    		console.log('delete row: ' + index)
    		
    		data.splice(index,1);
			grid.invalidate();

    	};

    	function loadInitialData(){
    		$.merge(data,testdata.getRandomRows(5));
			grid.invalidate();
    	}

		var grid;
		var columns = [
    		{id: "company", name: "Company", field: "company", width: 200},
    		{id: "currency", name: "Currency", field: "currency", width: 100 },
			{id: "price", name: "Price", field: "price", width: 100, cssClass: "numeric" },
			{id: "quantity", name: "Quantity", field: "quantity", width: 100, cssClass: "numeric" },
  			{id: "remove", name: "Remove", formatter: deleteRowLink, width: 100 }
    		];

  		var options = { 
  			enableColumnReorder : false
  		};

		var data = []; 

    	var grid = new Slick.Grid("#dataGrid", data, columns, options);
    	
    	testdata.onReady(loadInitialData);

		</script>

	</body>

</html>